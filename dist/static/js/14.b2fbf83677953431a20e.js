webpackJsonp([14],{DISF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("Hzmg"),o={data:function(){return{radioState:"",currentRow:{},currentBrandRow:"",type:"0",shVisible:!1,dialogVisible:!1,dialogVisibleDel:!1,tmpDelId:"",brandVisible:!1,value:"",addForm:{id:"",areaId:"",brandId:"",cateId:"",intervalPriceMax:"",intervalPriceMin:""},addFormExtend:{province:""},queryForm:{page:1,pageSize:10,cateName:"",brandName:"",areaName:"",status:"",approvalUser:"",createUser:""},queryFormBrand:{page:1,pageSize:10,englishName:"",id:"",name:"",productCateId:"",state:"",enableFlag:null},queryFormCate:{page:1,pageSize:10,id:"",name:"",visible:""},totalPages:0,tableData3:[],tableData4:[],options:{cate:[],brand:[],province:[],city:[],status:[{value:0,label:"待审核"},{value:1,label:"审核通过"},{value:2,label:"审核驳回"}]},optionsExtend:{brandClean:!0,areaClean:!0}}},props:{someValue:String},components:{contentHeader:l.a},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){this.queryList(),this.initCateOptions(),this.initProvinceOptions()},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},computed:{},watch:{"addForm.cateId":function(t){1==this.optionsExtend.brandClean&&(this.addForm.brandId=""),t?this.initBrandOptions(t):this.options.brand=[]},"addFormExtend.province":function(t){1==this.optionsExtend.areaClean&&(this.addForm.areaId=""),t?this.initCityOptions(t):this.options.city=[]}},methods:{handleCurrentChange:function(t){this.queryForm.page=t,this.queryList()},open:function(t){t?(this.type="1",this.dialogVisible=!0,this.addForm.id=t.id,this.optionsExtend.areaClean=!1,this.addFormExtend.province=t.province,this.addForm.areaId=t.areaId,this.optionsExtend.brandClean=!1,this.addForm.cateId=t.cateId,this.addForm.brandId=t.brandId,this.addForm.intervalPriceMax=t.intervalPriceMax,this.addForm.intervalPriceMin=t.intervalPriceMin):(this.type="0",this.dialogVisible=!0,this.addForm.id="",this.addFormExtend.province="",this.addForm.areaId="",this.addForm.brandId="",this.addForm.cateId="",this.addForm.intervalPriceMax="",this.addForm.intervalPriceMin="")},add:function(){var t=this;this.dialogVisible=!1,this.$axios.HttpPost("/api/rule/create",this.addForm).then(function(e){t.$message({type:"success",message:"新增成功"}),t.queryList()})},approve:function(){var t=this;this.shVisible=!1,this.$axios.HttpPut("/api/rule/operation/auditing",{id:this.currentRow.id,opt:this.radioState}).then(function(e){t.$message({type:"success",message:"审核提交成功"}),t.queryList()})},update:function(){var t=this;this.dialogVisible=!1,this.$axios.HttpPut("/api/rule/update",this.addForm).then(function(e){t.$message({type:"success",message:"修改成功"}),t.queryList()})},openDel:function(t){this.tmpDelId=t,this.dialogVisibleDel=!0},deleteById:function(){var t=this;this.$axios.HttpDel("/api/rule/delete/"+this.tmpDelId).then(function(e){t.$message({type:"success",message:"删除成功"}),t.tmpDelId="",t.dialogVisibleDel=!1,t.queryList()})},queryList:function(){var t=this;this.$axios.HttpGet("/api/rule/list",this.queryForm).then(function(e){t.totalPages=e.data.total,t.tableData3=e.data.list})},initCateOptions:function(){var t=this;this.$axios.HttpGet("/api/product/cate/options",{}).then(function(e){t.options.cate=e.data})},initBrandOptions:function(t){var e=this;this.$axios.HttpGet("/api/product/brand/options/"+t,{}).then(function(t){e.options.brand=t.data,e.optionsExtend.brandClean=!0})},initProvinceOptions:function(){var t=this;this.$axios.HttpGet("/api/areas/options/100000",{}).then(function(e){t.options.province=e.data})},initCityOptions:function(t){var e=this;this.$axios.HttpGet("/api/areas/options/"+t,{}).then(function(t){e.options.city=t.data,e.optionsExtend.areaClean=!0})},statusFmt:function(t,e){return this.$OPTIONS(t.status,this.options.status)}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"category"},[a("contentHeader",{attrs:{queryTitle:"查询条件"}}),t._v(" "),a("el-form",{attrs:{"label-width":"90px"}},[a("el-row",{staticStyle:{"margin-top":"1rem"}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"品类名称"}},[a("el-input",{attrs:{maxlength:"30",type:"text","auto-complete":"off",clearable:""},model:{value:t.queryForm.cateName,callback:function(e){t.$set(t.queryForm,"cateName",e)},expression:"queryForm.cateName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"品牌名称"}},[a("el-input",{attrs:{maxlength:"30",type:"text","auto-complete":"off",clearable:""},model:{value:t.queryForm.brandName,callback:function(e){t.$set(t.queryForm,"brandName",e)},expression:"queryForm.brandName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"区域"}},[a("el-input",{attrs:{maxlength:"30",type:"text","auto-complete":"off",clearable:""},model:{value:t.queryForm.areaName,callback:function(e){t.$set(t.queryForm,"areaName",e)},expression:"queryForm.areaName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.queryForm.status,callback:function(e){t.$set(t.queryForm,"status",e)},expression:"queryForm.status"}},t._l(t.options.status,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1),t._v(" "),a("el-row",{staticStyle:{"margin-top":"1rem"}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{attrs:{maxlength:"30",type:"text","auto-complete":"off",clearable:""},model:{value:t.queryForm.createUser,callback:function(e){t.$set(t.queryForm,"createUser",e)},expression:"queryForm.createUser"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"审核人"}},[a("el-input",{attrs:{maxlength:"30",type:"text","auto-complete":"off",clearable:""},model:{value:t.queryForm.approvalUser,callback:function(e){t.$set(t.queryForm,"approvalUser",e)},expression:"queryForm.approvalUser"}})],1)],1),t._v(" "),a("el-col",{attrs:{offset:1,span:3}},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:t.queryList}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(e){t.open(null)}}},[t._v("新增")])],1)],1)],1),t._v(" "),a("div",{staticClass:"list"},[a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData3,"tooltip-effect":"dark",size:"mini"}},[t._e(),t._v(" "),a("el-table-column",{attrs:{fixed:"left",prop:"cateName",label:"品类名称",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{fixed:"left",prop:"brandName",label:"品牌名称",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{fixed:"left",prop:"areaName",label:"区域",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"intervalPriceMin",label:"最小区间价格",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"intervalPriceMax",label:"最大区间价格",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"creater",label:"创建人",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"approvalTime",label:"审核时间",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"approvalUser",label:"审核人",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"审核状态",formatter:t.statusFmt,width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",width:"300",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.open(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.openDel(e.row.id)}}},[t._v("删除")]),t._v(" "),a("el-dialog",{attrs:{title:"提示",visible:t.dialogVisibleDel,width:"30%","append-to-body":""},on:{"update:visible":function(e){t.dialogVisibleDel=e},close:function(e){t.dialogVisibleDel=!1}}},[a("span",[t._v("确定删除？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisibleDel=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.deleteById}},[t._v("确 定")])],1)]),t._v(" "),1!=e.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(){t.shVisible=!0,t.currentRow=e.row}}},[t._v("审核")]):t._e()]}}])})],1)],1),t._v(" "),a("el-row",{staticClass:"page-choose",attrs:{type:"flex",justify:"center",align:"middle"}},[a("el-pagination",{attrs:{"page-size":t.queryForm.pageSize,"current-page":t.queryForm.page,layout:"total, prev, pager, next, jumper",total:t.totalPages},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"选择品牌",visible:t.brandVisible},on:{"update:visible":function(e){t.brandVisible=e}}},[a("el-table",{attrs:{"highlight-current-row":"",data:t.tableData4}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"品牌名称","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"englishName",label:"品牌英文名","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"productCateId",label:"关联品类","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"state",label:"审核状态","show-overflow-tooltip":""}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.brandVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(){t.selectBrand()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"0"==t.type?"新增规则":"修改规则",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{"label-width":"90px"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"品类"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择品类"},model:{value:t.addForm.cateId,callback:function(e){t.$set(t.addForm,"cateId",e)},expression:"addForm.cateId"}},t._l(t.options.cate,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"品牌"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择品牌"},model:{value:t.addForm.brandId,callback:function(e){t.$set(t.addForm,"brandId",e)},expression:"addForm.brandId"}},t._l(t.options.brand,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"省份"}},[a("el-select",{attrs:{placeholder:"请选择省份",clearable:""},model:{value:t.addFormExtend.province,callback:function(e){t.$set(t.addFormExtend,"province",e)},expression:"addFormExtend.province"}},t._l(t.options.province,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"城市"}},[a("el-select",{attrs:{placeholder:"请选择城市",clearable:""},model:{value:t.addForm.areaId,callback:function(e){t.$set(t.addForm,"areaId",e)},expression:"addForm.areaId"}},t._l(t.options.city,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"最低价格"}},[a("el-input",{attrs:{placeholder:"最低价格",maxlength:"11",clearable:""},model:{value:t.addForm.intervalPriceMin,callback:function(e){t.$set(t.addForm,"intervalPriceMin",e)},expression:"addForm.intervalPriceMin"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"最高价格"}},[a("el-input",{attrs:{placeholder:"最高价格",maxlength:"11",clearable:""},model:{value:t.addForm.intervalPriceMax,callback:function(e){t.$set(t.addForm,"intervalPriceMax",e)},expression:"addForm.intervalPriceMax"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(){t.dialogVisible=!1,"0"==t.type?t.add():t.update()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"审核",visible:t.shVisible},on:{"update:visible":function(e){t.shVisible=e}}},[a("el-form",{attrs:{"label-width":"90px"}},[a("el-form-item",{attrs:{label:"品类名称："}},[t._v("\n          "+t._s(this.currentRow.cateName)+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"品牌名称："}},[t._v("\n          "+t._s(this.currentRow.brandName)+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"城市区域："}},[t._v("\n          "+t._s(this.currentRow.areaName)+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"价格区间："}},[t._v("\n          "+t._s(this.currentRow.intervalPriceMin)+" ~ "+t._s(this.currentRow.intervalPriceMax)+" 元\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"审核意见："}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.radioState,callback:function(e){t.radioState=e},expression:"radioState"}},[a("el-radio",{attrs:{label:"success"}},[t._v("审核通过")]),t._v(" "),a("el-radio",{attrs:{label:"fail"}},[t._v("驳回")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{type:"textarea",maxlength:"500"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"审核意见"}},[a("el-input",{attrs:{type:"textarea"}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.shVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.approve}},[t._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var r=a("vSla")(o,i,!1,function(t){a("k4Nh")},"data-v-5835354a",null);e.default=r.exports},k4Nh:function(t,e){}});